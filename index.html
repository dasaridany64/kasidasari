<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Data Logger Debug</title>
    <style>
        body { 
            font-family: Arial, sans-serif; 
            padding: 20px; 
            background: #f0f0f0;
        }
        .container { 
            background: white; 
            padding: 20px; 
            border-radius: 10px; 
            box-shadow: 0 2px 5px rgba(0,0,0,0.1);
        }
        .debug-box { 
            background: #ffe6e6; 
            padding: 15px; 
            margin: 10px 0; 
            border-radius: 5px; 
            border: 1px solid #ffcccc;
        }
        input, textarea, select, button { 
            width: 100%; 
            padding: 10px; 
            margin: 5px 0; 
            border: 1px solid #ccc; 
            border-radius: 4px; 
        }
        button { 
            background: #4CAF50; 
            color: white; 
            border: none; 
            padding: 12px; 
            cursor: pointer; 
        }
        table { 
            width: 100%; 
            border-collapse: collapse; 
            margin-top: 20px; 
        }
        th, td { 
            border: 1px solid #ddd; 
            padding: 8px; 
            text-align: left; 
        }
        th { 
            background-color: #f2f2f2; 
        }
    </style>
</head>
<body>
    <div class="container">
        <h1>Data Logger Debug Mode</h1>
        
        <div class="debug-box" id="debugInfo">
            <strong>Debug Information:</strong><br>
            Status: Loading...
        </div>

        <form id="dataForm">
            <input type="text" id="name" placeholder="Name" required>
            <input type="date" id="date" required>
            <select id="category" required>
                <option value="">Select Category</option>
                <option value="work">Work</option>
                <option value="personal">Personal</option>
            </select>
            <textarea id="message" placeholder="Message" required></textarea>
            <button type="submit">Add Entry</button>
        </form>

        <div id="debugOutput"></div>

        <table>
            <thead>
                <tr>
                    <th>Name</th>
                    <th>Date</th>
                    <th>Category</th>
                    <th>Message</th>
                </tr>
            </thead>
            <tbody id="tableBody">
                <tr><td colspan="4">No data yet</td></tr>
            </tbody>
        </table>

        <button onclick="clearAllData()" style="background: #ff4444; margin-top: 20px;">Clear All Data</button>
        <button onclick="testLocalStorage()" style="background: #888;">Test Storage</button>
    </div>

    <script>
        // Debug function to show messages
        function debugLog(message) {
            document.getElementById('debugOutput').innerHTML += '<div>' + new Date().toLocaleTimeString() + ': ' + message + '</div>';
        }

        // Test if localStorage is working
        function testLocalStorage() {
            try {
                localStorage.setItem('test', '123');
                const testValue = localStorage.getItem('test');
                debugLog('LocalStorage test: ' + (testValue === '123' ? 'WORKING' : 'BROKEN'));
            } catch (error) {
                debugLog('LocalStorage ERROR: ' + error.message);
            }
        }

        // Clear all data
        function clearAllData() {
            localStorage.removeItem('dataLogEntries');
            loadLoggedEntries();
            debugLog('All data cleared');
        }

        // Load entries from storage
        function loadLoggedEntries() {
            try {
                const entries = JSON.parse(localStorage.getItem('dataLogEntries')) || [];
                const tableBody = document.getElementById('tableBody');
                
                if (entries.length === 0) {
                    tableBody.innerHTML = '<tr><td colspan="4">No data yet</td></tr>';
                } else {
                    tableBody.innerHTML = '';
                    entries.forEach(entry => {
                        const row = document.createElement('tr');
                        row.innerHTML = `
                            <td>${entry.name}</td>
                            <td>${entry.date}</td>
                            <td>${entry.category}</td>
                            <td>${entry.message}</td>
                        `;
                        tableBody.appendChild(row);
                    });
                }
                
                document.getElementById('debugInfo').innerHTML = 
                    '<strong>Debug Information:</strong><br>' +
                    'Entries loaded: ' + entries.length + '<br>' +
                    'LocalStorage: ' + (typeof localStorage !== 'undefined' ? 'Available' : 'Not Available');
                    
            } catch (error) {
                debugLog('Load error: ' + error.message);
            }
        }

        // Form submission
        document.getElementById('dataForm').addEventListener('submit', function(event) {
            event.preventDefault();
            
            try {
                const name = document.getElementById('name').value;
                const date = document.getElementById('date').value;
                const category = document.getElementById('category').value;
                const message = document.getElementById('message').value;
                
                const entry = { name, date, category, message, id: Date.now() };
                
                const entries = JSON.parse(localStorage.getItem('dataLogEntries')) || [];
                entries.push(entry);
                localStorage.setItem('dataLogEntries', JSON.stringify(entries));
                
                debugLog('Entry added: ' + name);
                loadLoggedEntries();
                this.reset();
                
            } catch (error) {
                debugLog('Submit error: ' + error.message);
            }
        });

        // Initial load
        document.addEventListener('DOMContentLoaded', function() {
            debugLog('Page loaded');
            testLocalStorage();
            loadLoggedEntries();
        });
    </script>
</body>
</html>
